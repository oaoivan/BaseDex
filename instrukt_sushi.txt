Вот уникальные идентификаторы для каждого типа:
1. Classic AMM (V2-like)

    Идентифицирующая функция: getReserves()

        Это самый простой и надежный признак. Если вызов этой функции проходит успешно, это классический пул.

    Уникальное свойство: Адрес фабрики (factory). Контракт пула имеет публичную переменную factory, и ее значение будет соответствовать адресу UniswapV2Factory. Для SushiSwap на Ethereum это 0xC0AEe478e3658e2610c5F7A4A2E1777cE9e4f2Ac.

2. Trident Pools (V3-like и другие типы)

Trident не является прямым форком Uniswap V3, поэтому у него нет функции slot0(). Вместо этого у него есть своя архитектура.

    Идентифицирующая функция: masterDeployer()

        Все пулы, созданные через Trident, содержат в себе публичную переменную masterDeployer. Вызов этой функции вернет адрес главного развертывателя Trident. Если этот вызов проходит успешно, это 100% пул Trident.

    Уникальное свойство: Адрес фабрики (pool factory). Пулы Trident также имеют ссылку на свою фабрику. Вам нужно будет проверить, соответствует ли этот адрес одной из официальных фабрик Trident (например, ConcentratedLiquidityPoolFactory, ConstantProductPoolFactory и т.д.).

Рекомендуемый алгоритм проверки:

    Попытайтесь вызвать getReserves() на адресе контракта пула.

        Успех: Это Classic AMM (V2-like).

        Неудача (функция не найдена): Переходите к следующему шагу.

    Попытайтесь вызвать masterDeployer().

        Успех: Это Trident Pool (V3-like).

        Неудача: Это неизвестный или сторонний тип пула.

Этот двухэтапный процесс является наиболее надежным способом программно различить два основных типа пулов SushiSwap.