Типы пулов в Trader Joe

    Classic AMM (V1):

        Что это: Это оригинальная версия Trader Joe, которая является прямым форком Uniswap V2.

        Технология: Использует стандартную формулу x*y=k.

        Аналог: Uniswap V2 / PancakeSwap V2.

    Liquidity Book (V2.1):

        Что это: Это инновационная модель Trader Joe для концентрированной ликвидности. Вместо плавного ценового диапазона, как в Uniswap V3, ликвидность здесь размещается в дискретных ценовых "бинах" (bins). Каждый "бин" по сути является отдельным пулом x*y=k на конкретной ценовой отметке.

        Технология: Дискретизированная концентрированная ликвидность. Не является форком Uniswap V3.

        Аналог: Концептуально похож на Uniswap V3, но с другой реализацией.

Как определить тип пула

Поскольку Trader Joe работает на EVM-совместимых сетях, идентификация происходит через вызов функций контракта.
Алгоритм проверки:

    Попытайтесь вызвать getReserves() на адресе контракта пула.

        Успех: Это Classic AMM (V1). Контракт будет иметь эту стандартную функцию из интерфейса Uniswap V2.

        Неудача (функция не найдена): Переходите к следующему шагу.

    Попытайтесь вызвать getActiveId().

        Успех: Это пул Liquidity Book (V2.1). Функция getActiveId() является уникальной для архитектуры Liquidity Book и возвращает ID текущего активного ценового "бина". Ее наличие — стопроцентный признак этого типа пула.

        Неудача: Это неизвестный тип пула.